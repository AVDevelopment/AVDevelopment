<!DOCTYPE html>
<html lang="en" data-ng-app="app">
<head>
    <meta charset="utf-8" />
    <title>SecretCMS</title>
    <meta name="description" content="Angularjs, Html5, Music, Landing, 4 in 1 ui kits package" />
    <meta name="keywords" content="AngularJS, angular, bootstrap, admin, dashboard, panel, app, charts, components,flat, responsive, layout, kit, ui, route, web, app, widgets" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <link rel="icon" href="favicon.ico" type="image/x-icon" />

    <script>
        function getCookie(cname) {
            var name = cname + "=";
            var ca = document.cookie.split(';');
            for (var i = 0; i < ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') c = c.substring(1);
                if (c.indexOf(name) != -1) return c.substring(name.length, c.length);
            }
            return undefined;
        }



        if (getCookie("UserId") == undefined) {
            window.location.replace("login.html" + GetReturnURL()); //uncomment later
        }
        function GetReturnURL() {
            var returnUrl = '';
            if (window.location.hash.length) {
                returnUrl += '?ReturnURL=' + encodeURIComponent(window.location.hash);
            }
            return returnUrl;
        }

    </script>

    <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="bower_components/animate.css/animate.css" type="text/css" />
    <link rel="stylesheet" href="bower_components/font-awesome/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="bower_components/simple-line-icons/css/simple-line-icons.css" type="text/css" />
    <link rel="stylesheet" href="css/font.css" type="text/css" />
    <link rel="stylesheet" href="css/app.css" type="text/css" />

</head>
<body ng-controller="AppCtrl">
    <div class="app" id="app" ng-class="{'app-header-fixed':app.settings.headerFixed, 'app-aside-fixed':app.settings.asideFixed, 'app-aside-folded':app.settings.asideFolded, 'app-aside-dock':app.settings.asideDock, 'container':app.settings.container}" ui-view></div>


    <!-- jQuery -->
    <script src="bower_components/jquery/dist/jquery.min.js"></script>
    <script src="bower_components/jquery-cookie/jquery.cookie.js"></script>
    <!-- jQuery UI CSS -->
    <script src="bower_components/jquery-ui/ui/jquery-ui.js"></script>
    <script src="bower_components/bootstrap/dist/js/bootstrap.js"></script>
    <script src="bower_components/Bootbox/bootbox.js"></script>
    <script src="bower_components/tinymce/tinymce.min.js"></script>

    <script>


        if (getCookie("UserId") == undefined) {
            $("#systemLoading").hide();
            window.location.replace("login.html" + GetReturnURL()); //uncomment later
        }

        function GetReturnURL() {
            var returnUrl = '';
            if (window.location.hash.length) {
                returnUrl += 'index.html?ReturnURL=' + encodeURIComponent(window.location.hash);
            }
            return returnUrl;
        }


        var APIUrl = 'api/';
        function validate() {
            if ($.cookie('UserId') == undefined) {
                window.location.replace("login.html" + GetReturnURL()); //uncomment later
            } else {
                $.ajax({
                    type: "GET",
                    url: APIUrl + "User/IsUserSesstionPresent",
                    contentType: "application/json",
                    async: false,
                    success: function (tempdata) {
                        if (tempdata.StatusCode == 405) {
                            bootbox.alert("Your session has been expired. We will be redirecting you to login page. Click OK to proceed.", function () {
                                $.removeCookie("UserId");
                                $.removeCookie("Username");
                                $.removeCookie("UserImage");
                                $.removeCookie("UserEmail");
                                window.location.replace("login.html" + GetReturnURL());
                            });
                        }
                    },
                    error: function (data) {
                    }
                });
            }
            return false;
        }

        function validatesession() {
            if ($.cookie('Session') === undefined) {  // if expired / non-existent
                $.ajax({
                    type: "GET",
                    url: APIUrl + "User/IsUserSesstionPresent",
                    contentType: "application/json",
                    async: false,
                    success: function (tempdata) {
                        if (tempdata.StatusCode == 405) {
                            bootbox.alert("Your session has been expired. We will be redirecting you to login page. Click OK to proceed.", function () {
                                $.removeCookie("UserId");
                                $.removeCookie("Username");
                                $.removeCookie("UserImage");
                                $.removeCookie("UserEmail");
                                window.location.replace("login.html" + GetReturnURL());
                            });
                        }
                    },
                    error: function (data) {
                    }
                });

            }
        }


        $(document).ready(function () {

            $.ajaxSetup({
                beforeSend: function (xhr) {
                    xhr.setRequestHeader('sessioncookie', $.cookie('Session'));
                }
            });

            validate();
            validatesession();
        });

    </script>


    <!-- Angular -->
    <script src="bower_components/angular/angular.js"></script>

    <script src="bower_components/angular-animate/angular-animate.js"></script>
    <script src="bower_components/angular-cookies/angular-cookies.js"></script>
    <script src="bower_components/angular-resource/angular-resource.js"></script>
    <script src="bower_components/angular-sanitize/angular-sanitize.js"></script>
    <script src="bower_components/angular-touch/angular-touch.js"></script>

    <script src="bower_components/angular-ui-router/release/angular-ui-router.js"></script>
    <script src="bower_components/ngstorage/ngStorage.js"></script>
    <script src="bower_components/angular-ui-utils/ui-utils.js"></script>


    <!-- bootstrap -->
    <script src="bower_components/angular-bootstrap/ui-bootstrap-tpls.js"></script>
    <!-- lazyload -->
    <script src="bower_components/oclazyload/dist/ocLazyLoad.js"></script>
    <!-- translate -->
    <script src="bower_components/angular-translate/angular-translate.js"></script>
    <script src="bower_components/angular-translate-loader-static-files/angular-translate-loader-static-files.js"></script>
    <script src="bower_components/angular-translate-storage-cookie/angular-translate-storage-cookie.js"></script>
    <script src="bower_components/angular-translate-storage-local/angular-translate-storage-local.js"></script>
    <script src="bower_components/angular-strap/angular-strap.min.js"></script>
    <script src="bower_components/angular-strap/angular-strap.tpl.min.js"></script>
    <!-- <script src="bower_components/angular-sortable/sortable.js"></script>-->
    <!-- App -->
    <script src="js/app.js"></script>
    <script src="js/config.js"></script>
    <script src="js/config.lazyload.js"></script>
    <script src="js/config.router.js"></script>
    <script src="js/main.js"></script>
    <script src="js/services/ui-load.js"></script>
    <script src="js/services/access-service.js"></script>
    <script src="js/services/web-service.js"></script>
    <script src="js/services/Category-service.js"></script>
    <script src="js/directives/setnganimate.js"></script>
    <script src="js/directives/ui-butterbar.js"></script>
    <script src="js/directives/ui-focus.js"></script>
    <script src="js/directives/ui-fullscreen.js"></script>
    <script src="js/directives/ui-jq.js"></script>
    <script src="js/directives/ui-module.js"></script>
    <script src="js/directives/ui-nav.js"></script>
    <script src="js/directives/ui-toggleclass.js"></script>
    <script src="js/angular-notification.js"></script>

    <!-- Lazy loading -->
</body>
</html>
